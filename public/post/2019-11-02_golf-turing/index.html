<!DOCTYPE html><html lang="en-us" >

<head>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="generator" content="Source Themes Academic 4.8.0">

  

  
  
  
  
  
    
    
    
  
  

  

  
  
  
    
  
  <meta name="description" content="Updates (May 2020): I originally wrote this Turing.jl version of the golf putting model in late 2019. Since then there have been many updates to the Turing.jl Julia package. I&rsquo;ve updated this blog post to be aligned with the latest release (v0.">

  
  <link rel="alternate" hreflang="en-us" href="/post/2019-11-02_golf-turing/">

  


  
  
  
  <meta name="theme-color" content="#2962ff">
  

  
  
  
  <script src="/js/mathjax-config.js"></script>
  

  
  
  
  
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/academicons/1.8.6/css/academicons.min.css" integrity="sha256-uFVgMKfistnJAfoCUQigIl+JfUaP47GrRKjf6CTPVmw=" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.0-1/css/all.min.css" integrity="sha256-4w9DunooKSr3MFXHXWyFER38WmPdm361bQS/2KUWZbU=" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.css" integrity="sha256-Vzbj7sDDS/woiFS3uNKo8eIuni59rjyNGtXfstRzStA=" crossorigin="anonymous">

    
    
    
      
    
    
      
      
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/styles/github.min.css" crossorigin="anonymous" title="hl-light">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/styles/github.min.css" crossorigin="anonymous" title="hl-dark" disabled>
      
    

    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.5.1/leaflet.css" integrity="sha256-SHMGCYmST46SoyGgo4YR/9AlK1vf3ff84Aq9yK4hdqM=" crossorigin="anonymous">
    

    

    
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/lazysizes/5.1.2/lazysizes.min.js" integrity="sha256-Md1qLToewPeKjfAHU1zyPwOutccPAm5tahnaw7Osw0A=" crossorigin="anonymous" async></script>
      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js" integrity="" crossorigin="anonymous" async></script>
      
    
      

      
      

      
    

  

  
  
  
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Montserrat:400,700%7CRoboto:400,400italic,700%7CRoboto+Mono&display=swap">
  

  
  
  
  
  <link rel="stylesheet" href="/css/academic.css">

  





<script async src="https://www.googletagmanager.com/gtag/js?id=UA-136620931-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];

  function gtag() {
      dataLayer.push(arguments);
  }

  function trackOutboundLink(url, target) {
    gtag('event', 'click', {
         'event_category': 'outbound',
         'event_label': url,
         'transport_type': 'beacon',
         'event_callback': function () {
           if (target !== '_blank') {
             document.location = url;
           }
         }
    });
    console.debug("Outbound link clicked: " + url);
  }

  function onClickCallback(event) {
    if ((event.target.tagName !== 'A') || (event.target.host === window.location.host)) {
      return;
    }
    trackOutboundLink(event.target, event.target.getAttribute('target'));  
  }

  gtag('js', new Date());
  gtag('config', 'UA-136620931-1', {});

  
  document.addEventListener('click', onClickCallback, false);
</script>


  


  
  

  

  <link rel="manifest" href="/index.webmanifest">
  <link rel="icon" type="image/png" href="/images/icon_hu0b7a4cb9992c9ac0e91bd28ffd38dd00_9727_32x32_fill_lanczos_center_2.png">
  <link rel="apple-touch-icon" type="image/png" href="/images/icon_hu0b7a4cb9992c9ac0e91bd28ffd38dd00_9727_192x192_fill_lanczos_center_2.png">

  <link rel="canonical" href="/post/2019-11-02_golf-turing/">

  
  
  
  
  
  
  
    
  
  
  <meta property="twitter:card" content="summary_large_image">
  
  <meta property="og:site_name" content="Josh Duncan">
  <meta property="og:url" content="/post/2019-11-02_golf-turing/">
  <meta property="og:title" content="Model building of golf putting with Turing.jl | Josh Duncan">
  <meta property="og:description" content="Updates (May 2020): I originally wrote this Turing.jl version of the golf putting model in late 2019. Since then there have been many updates to the Turing.jl Julia package. I&rsquo;ve updated this blog post to be aligned with the latest release (v0."><meta property="og:image" content="/post/2019-11-02_golf-turing/featured.png">
  <meta property="twitter:image" content="/post/2019-11-02_golf-turing/featured.png"><meta property="og:locale" content="en-us">
  
    
      <meta property="article:published_time" content="2020-05-25T00:00:00-05:00">
    
    <meta property="article:modified_time" content="2020-05-25T00:00:00-05:00">
  

  


    






  




<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "/post/2019-11-02_golf-turing/"
  },
  "headline": "Model building of golf putting with Turing.jl",
  
  "image": [
    "/post/2019-11-02_golf-turing/featured.png"
  ],
  
  "datePublished": "2020-05-25T00:00:00-05:00",
  "dateModified": "2020-05-25T00:00:00-05:00",
  
  "publisher": {
    "@type": "Organization",
    "name": "Josh Duncan",
    "logo": {
      "@type": "ImageObject",
      "url": "/images/icon_hu0b7a4cb9992c9ac0e91bd28ffd38dd00_9727_192x192_fill_lanczos_center_2.png"
    }
  },
  "description": "Updates (May 2020): I originally wrote this Turing.jl version of the golf putting model in late 2019. Since then there have been many updates to the Turing.jl Julia package. I\u0026rsquo;ve updated this blog post to be aligned with the latest release (v0."
}
</script>

  

  


  


  





  <title>Model building of golf putting with Turing.jl | Josh Duncan</title>

</head>

<body id="top" data-spy="scroll" data-offset="70" data-target="#TableOfContents" >

  <aside class="search-results" id="search">
  <div class="container">
    <section class="search-header">

      <div class="row no-gutters justify-content-between mb-3">
        <div class="col-6">
          <h1>Search</h1>
        </div>
        <div class="col-6 col-search-close">
          <a class="js-search" href="#"><i class="fas fa-times-circle text-muted" aria-hidden="true"></i></a>
        </div>
      </div>

      <div id="search-box">
        
        <input name="q" id="search-query" placeholder="Search..." autocapitalize="off"
        autocomplete="off" autocorrect="off" spellcheck="false" type="search">
        
      </div>

    </section>
    <section class="section-search-results">

      <div id="search-hits">
        
      </div>

    </section>
  </div>
</aside>


  







<nav class="navbar navbar-expand-lg navbar-light compensate-for-scrollbar" id="navbar-main">
  <div class="container">

    
    <div class="d-none d-lg-inline-flex">
      <a class="navbar-brand" href="/">Josh Duncan</a>
    </div>
    

    
    <button type="button" class="navbar-toggler" data-toggle="collapse"
            data-target="#navbar-content" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
    <span><i class="fas fa-bars"></i></span>
    </button>
    

    
    <div class="navbar-brand-mobile-wrapper d-inline-flex d-lg-none">
      <a class="navbar-brand" href="/">Josh Duncan</a>
    </div>
    

    
    
    <div class="navbar-collapse main-menu-item collapse justify-content-start" id="navbar-content">

      
      <ul class="navbar-nav d-md-inline-flex">
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#about"><span>Home</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#posts"><span>Blog</span></a>
        </li>

        
        

        

        
        
        

        
        
        
        
        
        

        <li class="nav-item">
          <a class="nav-link " href="/bio"><span>Bio</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#contact"><span>Contact</span></a>
        </li>

        
        

      

        
      </ul>
    </div>

    <ul class="nav-icons navbar-nav flex-row ml-auto d-flex pl-md-2">
      
      <li class="nav-item">
        <a class="nav-link js-search" href="#"><i class="fas fa-search" aria-hidden="true"></i></a>
      </li>
      

      

      

    </ul>

  </div>
</nav>


  <article class="article">

  




















  
  
    
  


<div class="article-container pt-3">
  <h1>Model building of golf putting with Turing.jl</h1>

  

  


<div class="article-metadata">

  
  

  
  <span class="article-date">
    
    
      
    
    May 25, 2020
  </span>
  

  

  
  <span class="middot-divider"></span>
  <span class="article-reading-time">
    13 min read
  </span>
  

  
  
  

  
  

</div>

  














</div>


<div class="article-header article-container featured-image-wrapper mt-4 mb-4" style="max-width: 720px; max-height: 480px;">
  <div style="position: relative">
    <img src="/post/2019-11-02_golf-turing/featured_hucf2f400c3512c27c5af2348fc972d925_760308_720x0_resize_lanczos_2.png" alt="" class="featured-image">
    
  </div>
</div>



  <div class="article-container">

    <div class="article-style">
      <h2 id="updates-may-2020">Updates (May 2020):</h2>
<p>I originally wrote this <code>Turing.jl</code> version of the golf putting model in late <code>2019</code>. Since then there have been many updates to the <code>Turing.jl</code> Julia package. I&rsquo;ve updated this blog post to be aligned with the latest release (<code>v0.13.0</code>) and have also included something new given that the latest release includes a feature for sampling from the prior distribution.</p>
<hr>
<h2 id="first-thing-disclaimer">First Thing (Disclaimer)</h2>
<p>This blog post is based on a blog post written by the popular bayesian statistician Andrew Gelman.</p>
<p>Dr. Gelman&rsquo;s post was written in the 
<a href="https://mc-stan.org/" target="_blank" rel="noopener">Stan</a> probabilistic programming language (or PPL). Since this post, there have been a couple other blog posts translating the code to other PPLs. They are excellent and I definitely recommend checking them out. Here&rsquo;s the list of links and my opinion on some of the benefits of reading each:</p>
<ul>
<li>Dr. Gelman&rsquo;s using Stan with R: See 
<a href="https://mc-stan.org/users/documentation/case-studies/golf.html" target="_blank" rel="noopener">here</a>. Read Dr. Gelman&rsquo;s post first as he lays out the problem being modeled here really well. Explaining the geometry at play and how to adjust the models to incorporate the physics of the problem. It&rsquo;s a great article showing the power of using a probabilistic programming language to build models.</li>
<li>Colin Carroll&rsquo;s using the Python PPL PyMC3: You can check out his work 
<a href="https://nbviewer.jupyter.org/github/pymc-devs/pymc3/blob/master/docs/source/notebooks/putting_workflow.ipynb" target="_blank" rel="noopener">here</a>. I really enjoyed Colin&rsquo;s post because of his prior and posterior predictive checks, data visualizations, and showing the value of these models moving past predictions.</li>
<li>Adam Haber&rsquo;s post using Python and Tensorflow Probability: See 
<a href="https://adamhaber.github.io/post/nuts/" target="_blank" rel="noopener">here</a>. His post goes into great detail about more of the sampling and lower level details of Tensorflow Probability and MCMC.</li>
</ul>
<p>My post is nothing really novel, simply a port to the Julia PPL, 
<a href="https://turing.ml/dev/" target="_blank" rel="noopener">Turing.jl</a>. This post shows how to specify and estimate these same models within the Julia programming language.</p>
<h2 id="getting-started-and-plotting">Getting started and plotting</h2>
<p>Let&rsquo;s Load the data and take a look:</p>
<pre><code class="language-julia">using Turing, HTTP, CSV
# Hide sampling progress.
Turing.turnprogress(false);

resp = HTTP.get(&quot;https://raw.githubusercontent.com/stan-dev/example-models/master/knitr/golf/golf_data.txt&quot;);
data = CSV.read(IOBuffer(resp.body), normalizenames = true, header = 3)

x, n, y = (data[:,1], data[:,2], data[:,3])
</code></pre>
<p>We have three variables in this dataset:</p>
<table>
<thead>
<tr>
<th>Variable</th>
<th>Units</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>x</td>
<td>feet</td>
<td>The distance of the attempted putt</td>
</tr>
<tr>
<td>n</td>
<td>count</td>
<td>The total attempts (or trials) of putts at a chosen distance</td>
</tr>
<tr>
<td>y</td>
<td>count</td>
<td>The total successful putts from the total attempts</td>
</tr>
</tbody>
</table>
<p>What we are attempting to build is a model to predict the probability of success given the distance from the hole. We need to transform this data a bit to explore the dataset visually. Let&rsquo;s calculate the probabilities and the error involved. We&rsquo;ll use the following formula to calculate the error bars for the putting success rate:</p>
<p>$$
\sqrt{\hat{p}_j(1-\hat{p}_j)/n_j}
$$</p>
<pre><code class="language-julia">pj = y ./ n
error = @. sqrt((pj * (1 - pj) / n));
</code></pre>
<p>Now let&rsquo;s visualize the dataset:</p>
<pre><code class="language-julia">using Plots

# plot out the error
scatter(
  x, pj,
  yerror= error,
  legend = false,
  ylim = (0, 1),
  ylab = &quot;Probability of Success&quot;,
  xlab = &quot;Distance from hole (ft)&quot;)
</code></pre>
<p><img src="/post/2020-05-25_golf-turing_files/golf-turing-rev2_3_1.svg" alt=""></p>
<h2 id="logistic-regression">Logistic Regression</h2>
<p>Building our first model, a GLM (Generalized Linear Model). We will attempt to model the probability of success in golf putting incorporating the distance as an independent (or predictor) variable.</p>
<p>$$
y_j\sim\mbox{binomial}(n_j, \mbox{logit}^{-1}(a + bx_j)),
\mbox{ for } j=1,\dots, J.
$$</p>
<pre><code class="language-julia">using StatsFuns: logistic

@model golf_logistic(x,y,n,J) = begin
  # parameters
  a ~ Normal(0, 1)
  b ~ Normal(0, 1)

  # model
  for i in 1:J
    p = logistic(a + b * x[i])
    y[i] ~ Binomial(n[i], p)
  end
end

chn = sample(golf_logistic(x, y, n, length(x)), NUTS(), MCMCThreads(), 4000, 4);
</code></pre>
<p>The <code>sample</code> method now allows for parallel sampling with either one thread per chain (<code>MCMCThreads</code>) or one process per chain (<code>MCMCDistributed</code>). Here I&rsquo;m using multithreading and am specifying <code>4</code> chains should be used.</p>
<p>Now that we&rsquo;ve sampled the joint probability distribution. Let&rsquo;s take a look at the results. I&rsquo;ll create a function to show the table of results as html using the <code>PrettyTables.jl</code> package. Looking at the summary statistics for the posterior distribution:</p>
<pre><code class="language-julia">using PrettyTables, DataFrames

formatters = (v,i,j) -&gt; (j &gt; 1) ? round(v, digits=3) : v

function prettystats(chains)
  chains |&gt;
    x -&gt; summarystats(x) |&gt;
    x -&gt; DataFrame(x) |&gt;
    x -&gt; pretty_table(x, backend = :html, formatters = formatters)
end

prettystats(chn)
</code></pre>
<!DOCTYPE html>
<html>
<meta charset="UTF-8">
<style>
table, td, th {
    border-collapse: collapse;
    font-family: sans-serif;
}
<p>td, th {
border-bottom: 0;
padding: 4px
}</p>
<p>tr:nth-child(odd) {
background: #eee;
}</p>
<p>tr:nth-child(even) {
background: #fff;
}</p>
<p>tr.header {
background: navy !important;
color: white;
font-weight: bold;
}</p>
<p>tr.subheader {
background: lightgray !important;
color: black;
}</p>
<p>tr.headerLastRow {
border-bottom: 2px solid black;
}</p>
<p>th.rowNumber, td.rowNumber {
text-align: right;
}</p>
<p></style></p>
<body>
<table>
<tr class = header>
<th style = "text-align: right; ">parameters</th>
<th style = "text-align: right; ">mean</th>
<th style = "text-align: right; ">std</th>
<th style = "text-align: right; ">naive_se</th>
<th style = "text-align: right; ">mcse</th>
<th style = "text-align: right; ">ess</th>
<th style = "text-align: right; ">r_hat</th>
</tr>
<tr class = "subheader headerLastRow">
<th style = "text-align: right; ">String</th>
<th style = "text-align: right; ">Float64</th>
<th style = "text-align: right; ">Float64</th>
<th style = "text-align: right; ">Float64</th>
<th style = "text-align: right; ">Float64</th>
<th style = "text-align: right; ">Float64</th>
<th style = "text-align: right; ">Float64</th>
</tr>
<tr>
<td style = "text-align: right; ">a</td>
<td style = "text-align: right; ">2.225</td>
<td style = "text-align: right; ">0.057</td>
<td style = "text-align: right; ">0.001</td>
<td style = "text-align: right; ">0.001</td>
<td style = "text-align: right; ">2997.531</td>
<td style = "text-align: right; ">1.002</td>
</tr>
<tr>
<td style = "text-align: right; ">b</td>
<td style = "text-align: right; ">-0.255</td>
<td style = "text-align: right; ">0.007</td>
<td style = "text-align: right; ">0.0</td>
<td style = "text-align: right; ">0.0</td>
<td style = "text-align: right; ">3137.058</td>
<td style = "text-align: right; ">1.002</td>
</tr>
</table>
</body>
</html>
<p>Visualizing the predictions:</p>
<pre><code class="language-julia">a_post = median(chn[:a].value)
b_post = median(chn[:b].value)

# iterator for distance from hole calcs
xrng = 1:1:21
post_lines = [logistic(a_post + b_post * x) for x = xrng]

# 50 draws from the posterior
using StatsBase
a_samp = StatsBase.sample(chn[:a].value, 50)
b_samp = StatsBase.sample(chn[:b].value, 50)

post_samp = [logistic(a_samp[i] + b_samp[i] * x) for x = xrng, i = 1:50]

plot!(post_samp, alpha = 0.5, color = :gray) # add uncertainty samples
plot!(post_lines, color = :black) # add median
</code></pre>
<p><img src="/post/2020-05-25_golf-turing_files/golf-turing-rev2_6_1.svg" alt=""></p>
<h2 id="first-principles">First Principles</h2>
<p>The next step is building a more bespoke model that incorporates the physics of this problem. Dr. Gelman describes this step as follows:</p>
<blockquote>
<p>We assume that the golfer is attempting to hit the ball completely straight but that many small factors interfere with this goal, so that the actual angle follows a normal distribution centered at 0 with some standard deviation σ.</p>
</blockquote>
<blockquote>
<p>The probability the ball goes in the hole is then the probability that the angle is less than the threshold; that is $$
\mbox{Pr}\left(|\mbox{angle}| &lt; \sin^{-1}((R-r)/x)\right) = 2\Phi\left(\frac{\sin^{-1}((R-r)/x)}{\sigma}\right) - 1
$$</p>
</blockquote>
<blockquote>
<p>where Φ is the cumulative normal distribution function.</p>
</blockquote>
<p>Again, for more background I would suggest reading the original post. So now we&rsquo;ll define the function <code>Phi</code>. It&rsquo;s the cumulative distribution function of the standard normal distribution.</p>
<pre><code class="language-julia">Phi(x) = cdf.(Normal(0, 1), x);
</code></pre>
<p>Now let&rsquo;s create and sample this model incorporating the angle.</p>
<pre><code class="language-julia">@model golf_angle(x, y, n, J, r, R) = begin
  # transformed data
  threshold_angle = asin.((R - r) ./ x)

  # parameters
  sigma ~ truncated(Normal(0, 1), 0, Inf)

  # model
  p = 2 * Phi(threshold_angle / sigma) .- 1
  for i in 1:J
    y[i] ~ Binomial(n[i], p[i])
  end
end

# radius of ball and hole respectively
r = (1.68 / 2) / 12
R = (4.25 / 2) / 12
</code></pre>
<p>Taking a note from 
<a href="https://nbviewer.jupyter.org/github/pymc-devs/pymc3/blob/master/docs/source/notebooks/putting_workflow.ipynb" target="_blank" rel="noopener">Colin&rsquo;s</a> book, we can perform prior predictive checks for the geometry-based model. In Turing we&rsquo;ll simply replace the sampler argument on the <code>sample</code> method with <code>Prior()</code>.</p>
<pre><code class="language-julia">prior = sample(golf_angle(x, y, n, length(x), r, R), Prior(), 4000)

angle_prior = StatsBase.sample(prior[:sigma].value, 500)
angle_of_shot = rand.(Normal.(0, angle_prior), 1)  # radians
angle_of_shot = getindex.(angle_of_shot) # extract array

distance = 20 # feet

end_positions = [
    distance * cos.(angle_of_shot),
    distance * sin.(angle_of_shot)
]

# visualize
 plot(
   [[0, i] for i in end_positions[1]],
   [[0, i] for i in end_positions[2]],
   labels = false,
   legend = :topleft,
   color = :black,
   alpha = 0.3,
   title = &quot;Prior distribution of putts from 20ft away&quot;
   )
scatter!(end_positions[1], end_positions[2], color = :black, labels = false)
scatter!((0,0), color = :green, label = &quot;start&quot;, markersize = 6)
scatter!((20, 0), color = :red, label = &quot;goal&quot;, markersize = 6)
</code></pre>
<p><img src="/post/2020-05-25_golf-turing_files/golf-turing-rev2_9_1.svg" alt=""></p>
<p>Now for the estimation of the parameters:</p>
<pre><code class="language-julia">chn2 = sample(golf_angle(x, y, n, length(x), r, R), NUTS(), MCMCThreads(), 4000, 4)
chn2 = hcat(chn2, Chains(chn2[:sigma].value * 180 / π, [&quot;sigma_degrees&quot;]))

prettystats(chn2)
</code></pre>
<!DOCTYPE html>
<html>
<meta charset="UTF-8">
<style>
table, td, th {
    border-collapse: collapse;
    font-family: sans-serif;
}
<p>td, th {
border-bottom: 0;
padding: 4px
}</p>
<p>tr:nth-child(odd) {
background: #eee;
}</p>
<p>tr:nth-child(even) {
background: #fff;
}</p>
<p>tr.header {
background: navy !important;
color: white;
font-weight: bold;
}</p>
<p>tr.subheader {
background: lightgray !important;
color: black;
}</p>
<p>tr.headerLastRow {
border-bottom: 2px solid black;
}</p>
<p>th.rowNumber, td.rowNumber {
text-align: right;
}</p>
<p></style></p>
<body>
<table>
<tr class = header>
<th style = "text-align: right; ">parameters</th>
<th style = "text-align: right; ">mean</th>
<th style = "text-align: right; ">std</th>
<th style = "text-align: right; ">naive_se</th>
<th style = "text-align: right; ">mcse</th>
<th style = "text-align: right; ">ess</th>
<th style = "text-align: right; ">r_hat</th>
</tr>
<tr class = "subheader headerLastRow">
<th style = "text-align: right; ">String</th>
<th style = "text-align: right; ">Float64</th>
<th style = "text-align: right; ">Float64</th>
<th style = "text-align: right; ">Float64</th>
<th style = "text-align: right; ">Float64</th>
<th style = "text-align: right; ">Float64</th>
<th style = "text-align: right; ">Float64</th>
</tr>
<tr>
<td style = "text-align: right; ">sigma</td>
<td style = "text-align: right; ">0.027</td>
<td style = "text-align: right; ">0.0</td>
<td style = "text-align: right; ">0.0</td>
<td style = "text-align: right; ">0.0</td>
<td style = "text-align: right; ">5818.38</td>
<td style = "text-align: right; ">1.0</td>
</tr>
<tr>
<td style = "text-align: right; ">sigma_degrees</td>
<td style = "text-align: right; ">1.527</td>
<td style = "text-align: right; ">0.023</td>
<td style = "text-align: right; ">0.0</td>
<td style = "text-align: right; ">0.0</td>
<td style = "text-align: right; ">5818.38</td>
<td style = "text-align: right; ">1.0</td>
</tr>
</table>
</body>
</html>
<p>Now we can calculate predictions and see how this model compares to the logistic model. Let&rsquo;s wrap the angle calculation into a function as we&rsquo;ll use it frequently throughout the post.</p>
<pre><code class="language-julia">prob_angle(threshold, sigma) = 2 * Phi(threshold / sigma) .- 1
</code></pre>
<p>Calculate and visualize predictions.</p>
<pre><code class="language-julia"># calculate predictions
post_sigma = median(chn2[:sigma].value)
threshold_angle = [asin((R - r) / x) for x = xrng]
geom_lines = prob_angle(threshold_angle, post_sigma)

scatter(
  x, pj,
  yerror= error,
  label = &quot;&quot;,
  ylim = (0, 1),
  ylab = &quot;Probability of Success&quot;,
  xlab = &quot;Distance from hole (ft)&quot;)
plot!(post_lines, color = :black, label = &quot;Logistic regression&quot;)
plot!(geom_lines, color = 1, label = &quot;Geometry-based model&quot;)
</code></pre>
<p><img src="/post/2020-05-25_golf-turing_files/golf-turing-rev2_12_1.svg" alt=""></p>
<p>We see that the geometry based model fits the data much better than the Logistic regression.</p>
<p>Now let&rsquo;s perform a posterior predictive check:</p>
<pre><code class="language-julia">angle_post = StatsBase.sample(chn2[:sigma].value, 500)
angle_of_shot = rand.(Normal.(0, angle_post), 1)  # radians
angle_of_shot = getindex.(angle_of_shot) # extract array

distance = 20 # feet

end_positions = [
    distance * cos.(angle_of_shot),
    distance * sin.(angle_of_shot)
]

# visualize
plot(
  [[0, i] for i in end_positions[1]],
  [[0, i] for i in end_positions[2]],
  xlim = (-21, 21),
  ylim = (-21, 21),
  labels = false,
  legend = :topleft,
  color = :black,
  alpha = 0.1,
  title = &quot;Posterior distribution of putts from 20ft away&quot;
  )
scatter!(end_positions[1], end_positions[2], color = :black, labels = false)
scatter!((0,0), color = :green, label = &quot;start&quot;, markersize = 6)
scatter!((20, 0), color = :red, label = &quot;goal&quot;, markersize = 6)
</code></pre>
<p><img src="/post/2020-05-25_golf-turing_files/golf-turing-rev2_13_1.svg" alt=""></p>
<h2 id="new-golf-data">New Golf Data</h2>
<p>Then came new data. Dr. Gelman received new data of golf putting and compared the fit of the original geometry based model with the old and new data. Here is the comparison below:</p>
<pre><code class="language-julia">respnew = HTTP.get(&quot;https://raw.githubusercontent.com/stan-dev/example-models/master/knitr/golf/golf_data_new.txt&quot;);
datanew = CSV.read(IOBuffer(respnew.body), normalizenames = true, header = 3)

xnew, nnew, ynew = (datanew[:,1], datanew[:,2], datanew[:,3])
pnew = ynew ./ nnew
xrngnew = 1:1:80

# plot the old model fit with new data
threshold_angle2 = [asin((R - r) / x) for x = xrngnew]
geom_lines2 = prob_angle(threshold_angle2, post_sigma)

scatter(
  x, pj,
  label = &quot;Old data&quot;,
  ylab = &quot;Probability of Success&quot;,
  xlab = &quot;Distance from hole (ft)&quot;,
  color = 1)
scatter!(xnew, pnew, color = 2, label = &quot;New data&quot;)
plot!(geom_lines2, label = &quot;&quot;, color = 1)
</code></pre>
<p><img src="/post/2020-05-25_golf-turing_files/golf-turing-rev2_14_1.svg" alt=""></p>
<p>We see that the new data have many more observations with longer distance putts than in the original data. The probability of success for these longer distance putts do not agree with the original geometry based model.</p>
<h2 id="updated-geometry">Updated Geometry</h2>
<p>So Dr. Gelman improves the model by taking distance into account.</p>
<blockquote>
<p>To get the ball in the hole, the angle isn’t the only thing you need to control; you also need to hit the ball just hard enough.</p>
</blockquote>
<blockquote>
<p>&hellip;the probability a shot goes in becomes, $$
\left(2\Phi\left(\frac{\sin^{-1}((R-r)/x)}{\sigma_{\rm angle}}\right) - 1\right)\left(\Phi\left(\frac{2}{(x+1),\sigma_{\rm distance}}\right) - \Phi\left(\frac{-1}{(x+1),\sigma_{\rm distance}}\right)\right)
$$</p>
</blockquote>
<blockquote>
<p>where we have renamed the parameter σ from our earlier model to σ_angle to distinguish it from the new σ_distance parameter.</p>
</blockquote>
<p>Let&rsquo;s add a function for the distance calculation for the improved geometry.</p>
<pre><code class="language-julia">prob_distance(distance, tol, overshot, sigma) =
  Phi((tol - overshot) ./ ((distance .+ overshot) * sigma)) -
    Phi(-overshot ./ ((distance .+ overshot) * sigma));
</code></pre>
<p>Now let&rsquo;s create the model to sample:</p>
<pre><code class="language-julia">@model golf_angle_dist(x, y, n, J, r, R, overshot, distance_tolerance) = begin
  # transformed data
  threshold_angle = asin.((R - r) ./ x)

  # parameters
  sigma_angle ~ truncated(Normal(0, 1), 0, Inf)
  sigma_distance ~ truncated(Normal(0, 1), 0, Inf)

  # model
  p_angle = prob_angle(threshold_angle, sigma_angle)
  p_distance = prob_distance(x, distance_tolerance, overshot, sigma_distance)
  p = p_angle .* p_distance

  for i in 1:J
    y[i] ~ Binomial(n[i], p[i])
  end
end

overshot = 1.
distance_tolerance = 3.

chn3 = sample(
  golf_angle_dist(xnew, ynew, nnew, length(xnew), r, R, overshot, distance_tolerance),
  NUTS(),
  MCMCThreads(),
  6000,
  4)

prettystats(chn3)
</code></pre>
<!DOCTYPE html>
<html>
<meta charset="UTF-8">
<style>
table, td, th {
    border-collapse: collapse;
    font-family: sans-serif;
}
<p>td, th {
border-bottom: 0;
padding: 4px
}</p>
<p>tr:nth-child(odd) {
background: #eee;
}</p>
<p>tr:nth-child(even) {
background: #fff;
}</p>
<p>tr.header {
background: navy !important;
color: white;
font-weight: bold;
}</p>
<p>tr.subheader {
background: lightgray !important;
color: black;
}</p>
<p>tr.headerLastRow {
border-bottom: 2px solid black;
}</p>
<p>th.rowNumber, td.rowNumber {
text-align: right;
}</p>
<p></style></p>
<body>
<table>
<tr class = header>
<th style = "text-align: right; ">parameters</th>
<th style = "text-align: right; ">mean</th>
<th style = "text-align: right; ">std</th>
<th style = "text-align: right; ">naive_se</th>
<th style = "text-align: right; ">mcse</th>
<th style = "text-align: right; ">ess</th>
<th style = "text-align: right; ">r_hat</th>
</tr>
<tr class = "subheader headerLastRow">
<th style = "text-align: right; ">String</th>
<th style = "text-align: right; ">Float64</th>
<th style = "text-align: right; ">Float64</th>
<th style = "text-align: right; ">Float64</th>
<th style = "text-align: right; ">Float64</th>
<th style = "text-align: right; ">Float64</th>
<th style = "text-align: right; ">Float64</th>
</tr>
<tr>
<td style = "text-align: right; ">sigma_angle</td>
<td style = "text-align: right; ">0.014</td>
<td style = "text-align: right; ">0.002</td>
<td style = "text-align: right; ">0.0</td>
<td style = "text-align: right; ">0.0</td>
<td style = "text-align: right; ">80.321</td>
<td style = "text-align: right; ">1.317</td>
</tr>
<tr>
<td style = "text-align: right; ">sigma_distance</td>
<td style = "text-align: right; ">0.135</td>
<td style = "text-align: right; ">0.01</td>
<td style = "text-align: right; ">0.0</td>
<td style = "text-align: right; ">0.001</td>
<td style = "text-align: right; ">80.321</td>
<td style = "text-align: right; ">1.36</td>
</tr>
</table>
</body>
</html>
<p>Dr. Gelman&rsquo;s post suggests something is unstable with this model estimation. The estimated parameters match his closely however we do have drastically different values for the <code>$\hat R$</code> diagnostics. I did notice that sampling this model did not always give me same results though. I ended up increasing the length of the chains to try to get around the inconsistent parameter estimation I was experiencing.</p>
<p>Now let&rsquo;s make some predictions and visualize the results:</p>
<pre><code class="language-julia"># calculate predictions
post_siga = median(chn3[:sigma_angle].value)
post_sigd = median(chn3[:sigma_distance].value)

p_angle = prob_angle(threshold_angle2, post_siga)
p_distance = prob_distance(xrngnew, distance_tolerance, overshot, post_sigd)

geom2_lines = p_angle .* p_distance

# plot
scatter(
  xnew, pnew,
  legend = false,
  color = 2,
  ylab = &quot;Probability of Success&quot;,
  xlab = &quot;Distance from hole (ft)&quot;)
plot!(geom2_lines, color = 2)
</code></pre>
<p><img src="/post/2020-05-25_golf-turing_files/golf-turing-rev2_17_1.svg" alt=""></p>
<p>Now this model fits the new data better than the original geometry based model but you can see an issue near the middle of the range of the x-axis (distance). Some of Gelman&rsquo;s select comments and proposed fix:</p>
<blockquote>
<p>There are problems with the fit in the middle of the range of x. We suspect this is a problem with the binomial error model, as it tries harder to fit points where the counts are higher. Look at how closely the fitted curve hugs the data at the very lowest values of x.</p>
</blockquote>
<blockquote>
<p>To fix this problem we took the data model, $ y_j \sim \mbox{binomial}(n_j, p_j) $, and added an independent error term to each observation.</p>
</blockquote>
<blockquote>
<p>&hellip;we first approximate the binomial data distribution by a normal and then add independent variance; thus: $$ y_j/n_j \sim \mbox{normal}\left(p_j, \sqrt{p_j(1-p_j)/n_j + \sigma_y^2}\right) $$</p>
</blockquote>
<h2 id="a-dispersed-model">A Dispersed Model</h2>
<p>Now let&rsquo;s implement the changes referenced above within Turing:</p>
<pre><code class="language-julia">@model golf_angle_dist_resid(x, y, n, J, r, R, overshot, distance_tolerance, raw) = begin
  # transformed data
  threshold_angle = asin.((R - r) ./ x)

  # parameters
  sigma_angle ~ truncated(Normal(0, 1), 0, Inf)
  sigma_distance ~ truncated(Normal(0, 1), 0, Inf)
  sigma_y ~ truncated(Normal(0, 1), 0, Inf)

  # model
  p_angle = prob_angle(threshold_angle, sigma_angle)
  p_distance = prob_distance(x, distance_tolerance, overshot, sigma_distance)
  p = p_angle .* p_distance

  for i in 1:J
    raw[i] ~ Normal(p[i], sqrt(p[i] * (1-p[i]) / n[i] + sigma_y^2))
  end
end

chn4 = sample(
  golf_angle_dist_resid(xnew, ynew, nnew, length(xnew), r, R, overshot, distance_tolerance, ynew ./ nnew),
  NUTS(),
  MCMCThreads(),
  4000,
  4)

# adding the conversion to degrees
chns = hcat(chn4, Chains(chn4[:sigma_angle].value * 180 / π, [&quot;sigma_degrees&quot;]))
prettystats(chns)
</code></pre>
<!DOCTYPE html>
<html>
<meta charset="UTF-8">
<style>
table, td, th {
    border-collapse: collapse;
    font-family: sans-serif;
}
<p>td, th {
border-bottom: 0;
padding: 4px
}</p>
<p>tr:nth-child(odd) {
background: #eee;
}</p>
<p>tr:nth-child(even) {
background: #fff;
}</p>
<p>tr.header {
background: navy !important;
color: white;
font-weight: bold;
}</p>
<p>tr.subheader {
background: lightgray !important;
color: black;
}</p>
<p>tr.headerLastRow {
border-bottom: 2px solid black;
}</p>
<p>th.rowNumber, td.rowNumber {
text-align: right;
}</p>
<p></style></p>
<body>
<table>
<tr class = header>
<th style = "text-align: right; ">parameters</th>
<th style = "text-align: right; ">mean</th>
<th style = "text-align: right; ">std</th>
<th style = "text-align: right; ">naive_se</th>
<th style = "text-align: right; ">mcse</th>
<th style = "text-align: right; ">ess</th>
<th style = "text-align: right; ">r_hat</th>
</tr>
<tr class = "subheader headerLastRow">
<th style = "text-align: right; ">String</th>
<th style = "text-align: right; ">Float64</th>
<th style = "text-align: right; ">Float64</th>
<th style = "text-align: right; ">Float64</th>
<th style = "text-align: right; ">Float64</th>
<th style = "text-align: right; ">Float64</th>
<th style = "text-align: right; ">Float64</th>
</tr>
<tr>
<td style = "text-align: right; ">sigma_angle</td>
<td style = "text-align: right; ">0.018</td>
<td style = "text-align: right; ">0.0</td>
<td style = "text-align: right; ">0.0</td>
<td style = "text-align: right; ">0.0</td>
<td style = "text-align: right; ">5026.215</td>
<td style = "text-align: right; ">1.001</td>
</tr>
<tr>
<td style = "text-align: right; ">sigma_distance</td>
<td style = "text-align: right; ">0.08</td>
<td style = "text-align: right; ">0.001</td>
<td style = "text-align: right; ">0.0</td>
<td style = "text-align: right; ">0.0</td>
<td style = "text-align: right; ">4901.694</td>
<td style = "text-align: right; ">1.0</td>
</tr>
<tr>
<td style = "text-align: right; ">sigma_y</td>
<td style = "text-align: right; ">0.003</td>
<td style = "text-align: right; ">0.001</td>
<td style = "text-align: right; ">0.0</td>
<td style = "text-align: right; ">0.0</td>
<td style = "text-align: right; ">6563.99</td>
<td style = "text-align: right; ">1.0</td>
</tr>
<tr>
<td style = "text-align: right; ">sigma_degrees</td>
<td style = "text-align: right; ">1.02</td>
<td style = "text-align: right; ">0.006</td>
<td style = "text-align: right; ">0.0</td>
<td style = "text-align: right; ">0.0</td>
<td style = "text-align: right; ">5026.215</td>
<td style = "text-align: right; ">1.001</td>
</tr>
</table>
</body>
</html>
<p>Calculate predictions and visualize:</p>
<pre><code class="language-julia">post_siga = median(chn4[:sigma_angle].value)
post_sigd = median(chn4[:sigma_distance].value)

p_angle2 = prob_angle(threshold_angle2, post_siga)
p_distance2 = prob_distance(xrngnew, distance_tolerance, overshot, post_sigd)

geom_lines2 = p_angle2 .* p_distance2

# plot
scatter(
  xnew, pnew,
  legend = false,
  color = 2,
  ylab = &quot;Probability of Success&quot;,
  xlab = &quot;Distance from hole (ft)&quot;)
plot!(geom_lines2, color = 2)
</code></pre>
<p><img src="/post/2020-05-25_golf-turing_files/golf-turing-rev2_19_1.svg" alt=""></p>
<p>We can see that this adjusted first principles based model is fitting the data much better now! To add to that, it also sampled faster and more consistently during my testing. This case study really shows off the power of a bayesian approach. The modeler has the ability to expand a model using domain knowledge and craft a model that makes sense and aligns with the data generating process.</p>
<h2 id="conclusion">Conclusion</h2>
<p>If you made it this far, thanks for checking out this post! I personally appreciate all of the great scientists, applied statisticians, etc. that have created and shared the other posts I referenced as well as the team developing the Turing PPL within Julia. It&rsquo;s really exciting to see a PPL written entirely in one language. In my opinion, it shows the strengths of the Julia language and is an example of its promise to solve the 
<a href="https://www.youtube.com/watch?v=B9moDuSYzGo" target="_blank" rel="noopener">two-language problem</a>.</p>
<h2 id="references">References</h2>
<ul>
<li>
<a href="https://mc-stan.org/" target="_blank" rel="noopener">Stan: a state-of-the-art platform for statistical modeling and high-performance statistical computation</a></li>
<li>
<a href="https://mc-stan.org/users/documentation/case-studies/golf.html" target="_blank" rel="noopener">Model building and expansion for golf putting - Gelman</a></li>
<li>
<a href="https://nbviewer.jupyter.org/github/pymc-devs/pymc3/blob/master/docs/source/notebooks/putting_workflow.ipynb" target="_blank" rel="noopener">Model building and expansion for golf putting - Carroll</a></li>
<li>
<a href="https://adamhaber.github.io/post/nuts/" target="_blank" rel="noopener">Bayesian golf puttings, NUTS, and optimizing your sampling function with TensorFlow Probability</a></li>
<li>
<a href="https://turing.ml/dev/" target="_blank" rel="noopener">Turing.jl: A library for robust, efficient, general-purpose probabilistic programming</a></li>
<li>
<a href="https://julialang.org/blog/2019/07/multithreading" target="_blank" rel="noopener">Announcing composable multi-threaded parallelism in Julia</a></li>
<li>
<a href="https://www.youtube.com/watch?v=B9moDuSYzGo" target="_blank" rel="noopener">ODSC East 2016 | Stefan Karpinski - &ldquo;Solving the Two Language Problem&rdquo;</a></li>
</ul>

    </div>

    





<div class="article-tags">
  
  <a class="badge badge-light" href="/tag/bayes/">bayes</a>
  
  <a class="badge badge-light" href="/tag/julia/">julia</a>
  
  <a class="badge badge-light" href="/tag/turing.jl/">Turing.jl</a>
  
</div>



<div class="share-box" aria-hidden="true">
  <ul class="share">
    
      
      
      
        
      
      
      
      <li>
        <a href="https://twitter.com/intent/tweet?url=/post/2019-11-02_golf-turing/&amp;text=Model%20building%20of%20golf%20putting%20with%20Turing.jl" target="_blank" rel="noopener" class="share-btn-twitter">
          <i class="fab fa-twitter"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://www.facebook.com/sharer.php?u=/post/2019-11-02_golf-turing/&amp;t=Model%20building%20of%20golf%20putting%20with%20Turing.jl" target="_blank" rel="noopener" class="share-btn-facebook">
          <i class="fab fa-facebook"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="mailto:?subject=Model%20building%20of%20golf%20putting%20with%20Turing.jl&amp;body=/post/2019-11-02_golf-turing/" target="_blank" rel="noopener" class="share-btn-email">
          <i class="fas fa-envelope"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://www.linkedin.com/shareArticle?url=/post/2019-11-02_golf-turing/&amp;title=Model%20building%20of%20golf%20putting%20with%20Turing.jl" target="_blank" rel="noopener" class="share-btn-linkedin">
          <i class="fab fa-linkedin-in"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://web.whatsapp.com/send?text=Model%20building%20of%20golf%20putting%20with%20Turing.jl%20/post/2019-11-02_golf-turing/" target="_blank" rel="noopener" class="share-btn-whatsapp">
          <i class="fab fa-whatsapp"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://service.weibo.com/share/share.php?url=/post/2019-11-02_golf-turing/&amp;title=Model%20building%20of%20golf%20putting%20with%20Turing.jl" target="_blank" rel="noopener" class="share-btn-weibo">
          <i class="fab fa-weibo"></i>
        </a>
      </li>
    
  </ul>
</div>












  
  





  
    
    
    
      
    
    
    
    <div class="media author-card content-widget-hr">
      
        
        <img class="avatar mr-3 avatar-circle" src="/author/avatar_hu0aa19ccfb82a000d534a4472933defe3_425354_270x270_fill_q90_lanczos_center.jpg" alt="">
      

      <div class="media-body">
        <h5 class="card-title"><a href="/"></a></h5>
        <h6 class="card-subtitle">Business Analyst</h6>
        <p class="card-text">Just exploring the model space.</p>
        <ul class="network-icon" aria-hidden="true">
  
    
    
    
      
    
    
    
    
    
      
    
    <li>
      <a href="/#contact" >
        <i class="fas fa-envelope"></i>
      </a>
    </li>
  
    
    
    
      
    
    
    
    
    
      
    
    <li>
      <a href="https://twitter.com/joshualeond" target="_blank" rel="noopener">
        <i class="fab fa-twitter"></i>
      </a>
    </li>
  
    
    
    
      
    
    
    
    
    
      
    
    <li>
      <a href="https://github.com/joshualeond" target="_blank" rel="noopener">
        <i class="fab fa-github"></i>
      </a>
    </li>
  
    
    
    
      
    
    
    
    
    
      
    
    <li>
      <a href="https://www.linkedin.com/in/joshua-duncan-580913121/" target="_blank" rel="noopener">
        <i class="fab fa-linkedin"></i>
      </a>
    </li>
  
</ul>

      </div>
    </div>
  












  
  
  <div class="article-widget content-widget-hr">
    <h3>Related</h3>
    <ul>
      
      <li><a href="/post/2019-03-26_market-dem-with-iv/">Market Demand with Instrumental Variables</a></li>
      
      <li><a href="/post/2019-03-16_kde-scratch/">Kernel Density Estimation from Scratch</a></li>
      
    </ul>
  </div>
  



  </div>
</article>

      

    
    
    
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.imagesloaded/4.1.4/imagesloaded.pkgd.min.js" integrity="sha256-lqvxZrPLtfffUl2G/e7szqSvPBILGbwmsGE1MKlOi0Q=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.isotope/3.0.6/isotope.pkgd.min.js" integrity="sha256-CBrpuqrMhXwcLLUd5tvQ4euBHCdh7wGlDfNz8vbu/iI=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.js" integrity="sha256-yt2kYMy0w8AbtF89WXb2P1rfjcP/HTHLT7097U8Y5b8=" crossorigin="anonymous"></script>

      

      
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/highlight.min.js" integrity="sha256-eOgo0OtLL4cdq7RdwRUiGKLX9XsIJ7nGhWEKbohmVAQ=" crossorigin="anonymous"></script>
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/languages/r.min.js"></script>
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/languages/julia.min.js"></script>
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/languages/stan.min.js"></script>
        
      

    

    
    
      <script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.5.1/leaflet.js" integrity="sha256-EErZamuLefUnbMBQbsEqu1USa+btR2oIlCpBJbyD4/g=" crossorigin="anonymous"></script>
    

    
    
    <script>const code_highlighting = true;</script>
    

    
    
    <script>const isSiteThemeDark = false;</script>
    

    
    
    
    
    
    
    <script>
      const search_config = {"indexURI":"/index.json","minLength":1,"threshold":0.3};
      const i18n = {"no_results":"No results found","placeholder":"Search...","results":"results found"};
      const content_type = {
        'post': "Posts",
        'project': "Projects",
        'publication' : "Publications",
        'talk' : "Talks"
        };
    </script>
    

    
    

    
    
    <script id="search-hit-fuse-template" type="text/x-template">
      <div class="search-hit" id="summary-{{key}}">
      <div class="search-hit-content">
        <div class="search-hit-name">
          <a href="{{relpermalink}}">{{title}}</a>
          <div class="article-metadata search-hit-type">{{type}}</div>
          <p class="search-hit-description">{{snippet}}</p>
        </div>
      </div>
      </div>
    </script>
    

    
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/3.2.1/fuse.min.js" integrity="sha256-VzgmKYmhsGNNN4Ph1kMW+BjoYJM2jV5i4IlFoeZA9XI=" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script>
    

    
    

    
    

    
    

    
    
    
    
    
    
    
    
    
      
    
    
    
    
    <script src="/js/academic.min.37431be2d92d7fb0160054761ab79602.js"></script>

    






  
  
  <div class="container">
    <footer class="site-footer">
  
  <p class="powered-by">
    
      <a href="/privacy/">Privacy Policy</a>
    
    
  </p>
  

  <p class="powered-by">
    
  </p>

  
  






  <p class="powered-by">
    Powered by the
    <a href="https://sourcethemes.com/academic/" target="_blank" rel="noopener">Academic theme</a> for
    <a href="https://gohugo.io" target="_blank" rel="noopener">Hugo</a>.

    
    <span class="float-right" aria-hidden="true">
      <a href="#" class="back-to-top">
        <span class="button_icon">
          <i class="fas fa-chevron-up fa-2x"></i>
        </span>
      </a>
    </span>
    
  </p>
</footer>

  </div>
  

  
<div id="modal" class="modal fade" role="dialog">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Cite</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <pre><code class="tex hljs"></code></pre>
      </div>
      <div class="modal-footer">
        <a class="btn btn-outline-primary my-1 js-copy-cite" href="#" target="_blank">
          <i class="fas fa-copy"></i> Copy
        </a>
        <a class="btn btn-outline-primary my-1 js-download-cite" href="#" target="_blank">
          <i class="fas fa-download"></i> Download
        </a>
        <div id="modal-error"></div>
      </div>
    </div>
  </div>
</div>

</body>
</html>
